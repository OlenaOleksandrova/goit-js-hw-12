{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nexport const BASE_URL = 'https://pixabay.com/api/';\nexport const API_KEY = '46110623-cffeede45492ee1adb33fe3c4';\nexport const PER_PAGE = 15;\n\nexport async function fetchImages(query, currentPage = 1) {\n    const params = new URLSearchParams({\n        key: API_KEY,\n        q: query,\n        image_type: 'photo',\n        orientation: 'horizontal',\n        safesearch: 'true',\n        page: currentPage,\n        per_page: PER_PAGE,\n\n    });\n\n    const url = `${BASE_URL}?${params}`;\n\n    try {\n        const data = await axios.get(url);\n        console.log('fetchImages data:', data.data);\n        return data.data;\n    } catch (error) {\n        console.error('Error fetching images:', error);\n    }\n\n}\n    \n\n","export function renderImages(images) {\n    return images.reduce((acc, item) => {\n        return (\n            acc +\n            `<article class=\"gallery-item\">\n                <a href=\"${item.largeImageURL}\" class=\"gallery-link\">\n                    <img src=\"${item.webformatURL}\" alt=\"${item.tags}\" class=\"gallery-image\" />\n                </a>\n                <ul class=\"info\">\n                    <li class=\"info-item\"><strong>Likes:</strong> ${item.likes}</li>\n                    <li class=\"info-item\"><strong>Views:</strong> ${item.views}</li>\n                    <li class=\"info-item\"><strong>Comments:</strong> ${item.comments}</li>\n                    <li class=\"info-item\"><strong>Downloads:</strong> ${item.downloads}</li>\n                </ul>\n            </article>`\n        );\n    }, '');\n}","import { fetchImages, PER_PAGE } from './js/pixabay-api.js';\nimport { renderImages } from './js/render-functions.js';\nimport axios from 'axios';\nimport SimpleLightbox from \"simplelightbox\";\n\n\nconst searchForm = document.querySelector('.search-form');\n// const loaderEl = document.querySelector('.loader'); \nconst imagesBoxEl = document.querySelector('.gallery');\nconst loadMore = document.querySelector('.js-load-more');\nconst messageBox = document.querySelector('.message');\nconst loader = document.querySelector('.loader'); \n\nlet currentPage = 1;\nlet query = null;\nlet totalPages = 0;\nlet gallery = null;\n\n// подія форми\n\nsearchForm.addEventListener('submit', handleSubmit);\nloadMore.addEventListener('click', handleLoadMore);\n\nasync function handleSubmit(event) {\n    event.preventDefault();\n\n    // loader.classList.remove('is-hidden');\n    const form = event.currentTarget;\n    query = form.elements.query.value.trim(); \n \n    if (!query) {\n        return;\n    }\n\n    currentPage = 1;\n    imagesBoxEl.innerHTML = ''; \n    loadMore.classList.add('is-hidden');\n\n    try {\n        showLoader(); \n        const response = await fetchImages(query, currentPage);\n        totalPages = Math.ceil(response.totalHits / PER_PAGE);\n\n         if (response.totalHits === 0) {\n            showMessage(\"Sorry, there are no images matching your search query. Please try again!\");\n            // loadMore.classList.add('is-hidden');\n            return;\n        }\n\n        const imagesMarkup = renderImages(response.hits);\n        imagesBoxEl.innerHTML = imagesMarkup;\n\n          if (!gallery) {\n            gallery = new SimpleLightbox('.gallery a', {\n                captionsData: 'alt',\n                captionDelay: 250,\n            });\n        } else {\n            gallery.refresh();\n        }\n       \n        if (currentPage < totalPages) {  \n             loadMore.classList.remove('is-hidden'); // Показ. кнопку\n        }\n      } catch (error) {\n          console.error('Error:', error);\n    } finally {\n        hideLoader(); \n        form.reset();\n    }\n}\n\nasync function handleLoadMore() {\n    currentPage += 1;\n    try {\n        showLoader(); \n         const response = await fetchImages(query, currentPage);\n        // console.log('handleLoadMore:', response);\n\n         const imagesMarkup = renderImages(response.hits);\n        imagesBoxEl.insertAdjacentHTML('beforeend', imagesMarkup);\n\n        //  if (response.totalHits === 0) {\n        //     showMessage(\"Sorry, there are no images matching your search query. Please try again!\");\n        //     return;\n        // }\n        gallery.refresh();\n\n        if (currentPage >= totalPages) {\n            loadMore.classList.add('is-hidden');\n            showMessage(\"We're sorry, but you've reached the end of search results.\");\n        } \n        \n        handleScrollView(); \n     \n    } catch (error) {\n         console.error('Error:', error);\n     } finally {\n         hideLoader();\n    }\n}\n\n// / Показ. завантажувач\nfunction showLoader() {\n    loader.style.display = 'block';\n}\n\n// Хов. завантажувач\nfunction hideLoader() {\n    loader.style.display = 'none';\n}\n\n// показати повідомлення при 0 результаті\nfunction showMessage(message) {\n    messageBox.textContent = message;\n    messageBox.classList.remove('is-hidden');\n\n    // Сховати повідомлення\n    setTimeout(() => {\n        messageBox.classList.add('is-hidden'); \n        // messageBox.textContent = ''; \n    }, 3000);\n}\n\n// Скрол після завантаження партії картинок\nfunction handleScrollView() {\n    const lastArticle = imagesBoxEl.lastElementChild;\n    if (lastArticle) {\n        const articleHeight = lastArticle.getBoundingClientRect().height;\n        window.scrollBy({\n            top: articleHeight * 2,\n            left: 0,\n            behavior: 'smooth',\n        });\n    } else {\n        console.error('Were sorry, but you have reached the end of search results.');\n    }\n}"],"names":["BASE_URL","API_KEY","PER_PAGE","fetchImages","query","currentPage","params","url","data","axios","error","renderImages","images","acc","item","searchForm","imagesBoxEl","loadMore","messageBox","loader","totalPages","gallery","handleSubmit","handleLoadMore","event","form","showLoader","response","showMessage","imagesMarkup","SimpleLightbox","hideLoader","handleScrollView","message","lastArticle","articleHeight"],"mappings":"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"}