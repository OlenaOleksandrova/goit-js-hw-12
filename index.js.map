{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nexport const BASE_URL = 'https://pixabay.com/api/';\nexport const API_KEY = '46110623-cffeede45492ee1adb33fe3c4';\nexport const PER_PAGE = 15;\n\nexport async function fetchImages(query, currentPage = 1) {\n    const params = new URLSearchParams({\n        key: API_KEY,\n        q: query,\n        image_type: 'photo',\n        orientation: 'horizontal',\n        safesearch: 'true',\n        page: currentPage,\n        per_page: PER_PAGE,\n\n    });\n\n    const url = `${BASE_URL}?${params}`;\n\n    try {\n        const data = await axios.get(url);\n        console.log('fetchImages data:', data.data);\n        return data.data;\n    } catch (error) {\n        console.error('Error fetching images:', error);\n    }\n\n}\n    \n\n","export function renderImages(images) {\n    return images.reduce((acc, item) => {\n        return (\n            acc +\n            `<article class=\"gallery-item\">\n                <a href=\"${item.largeImageURL}\" class=\"gallery-link\">\n                    <img src=\"${item.webformatURL}\" alt=\"${item.tags}\" class=\"gallery-image\" />\n                </a>\n                <ul class=\"info\">\n                    <li class=\"info-item\"><strong>Likes:</strong> ${item.likes}</li>\n                    <li class=\"info-item\"><strong>Views:</strong> ${item.views}</li>\n                    <li class=\"info-item\"><strong>Comments:</strong> ${item.comments}</li>\n                    <li class=\"info-item\"><strong>Downloads:</strong> ${item.downloads}</li>\n                </ul>\n            </article>`\n        );\n    }, '');\n}","import { fetchImages, PER_PAGE } from './js/pixabay-api.js';\nimport { renderImages } from './js/render-functions.js';\nimport axios from 'axios';\nimport SimpleLightbox from \"simplelightbox\";\n\n\nconst searchForm = document.querySelector('.search-form');\n// const loaderEl = document.querySelector('.loader'); \nconst imagesBoxEl = document.querySelector('.gallery');\nconst loadMore = document.querySelector('.js-load-more');\nconst messageBox = document.querySelector('.message');\n\nlet currentPage = 1;\nlet query = null;\nlet pages = 0;\nlet gallery;\n\n// подія форми\n\nsearchForm.addEventListener('submit', handleSubmit);\nloadMore.addEventListener('click', handleLoadMore);\n   \n// let gallery = new SimpleLightbox('.gallery a', {\n//   captionsData: 'alt',\n//   captionDelay: 250,\n// });  \n\nasync function handleSubmit(event) {\n    event.preventDefault();\n\n     const form = event.currentTarget;\n    query = form.elements.query.value.trim(); \n \n    if (!query) {\n        return;\n    }\n\n     currentPage = 1;\n\n    try {\n        const response = await fetchImages(query, currentPage);\n        pages = Math.ceil(response.totalHits / PER_PAGE);\n        console.log('handleSubmit:', response);\n\n         if (response.totalHits === 0) {\n            showMessage(\"Sorry, there are no images matching your search query. Please try again!\");\n            imagesBoxEl.innerHTML = '';\n            loadMore.classList.add('is-hidden');\n            return;\n        }\n\n        const imagesMarkup = renderImages(response.hits);\n        imagesBoxEl.innerHTML = imagesMarkup;\n\n         gallery = new SimpleLightbox('.gallery a', {\n            captionsData: 'alt',\n            captionDelay: 250,\n        }); \n\n        // gallery.refresh();\n\n         if (response.totalHits > currentPage * PER_PAGE) {\n             loadMore.classList.remove('is-hidden'); // Показ. кнопку\n         } else {\n             loadMore.classList.add('is-hidden'); // Хов. кнопку\n}\n\n        // LoadMore.classList.remove('is-hidden'); \n        \n    } catch (error) {\n        console.error('Error:', error);\n\n    } finally {\n        form.reset();\n    }\n}\n\nasync function handleLoadMore() {\n    currentPage += 1;\n    console.log(pages);\n    try {\n       \n         const response = await fetchImages(query, currentPage);\n        console.log('handleLoadMore:', response);\n\n         if (response.totalHits === 0) {\n            showMessage(\"Sorry, there are no images matching your search query. Please try again!\");\n            return;\n        }\n\nconst imagesMarkup = renderImages(response.hits);\n        imagesBoxEl.insertAdjacentHTML('beforeend', imagesMarkup);\n        // imagesBoxEl.innerHTML = imagesMarkup;\n\n          gallery.refresh();\n\n        handleScrollView();\n        \n        if (currentPage >= pages) {\n            loadMore.classList.add('is-hidden');\n            console.log(\"We're sorry, but you've reached the end of search results.\");\n        }\n    } catch (error) {\n         console.error('Error:', error);\n     }\n}\n\n// показати повідомлення при 0 результаті\nfunction showMessage(message) {\n    messageBox.textContent = message;\n    messageBox.classList.remove('is-hidden'); // Показ. повідомлення\n\n    // Сховати повідомлення\n    setTimeout(() => {\n        messageBox.classList.add('is-hidden'); \n        messageBox.textContent = ''; \n    }, 3000);\n}\n \n// Скрол після завантаження партії картинок\nfunction handleScrollView() {\n    const lastArticle = imagesBoxEl.lastElementChild;\n    if (lastArticle) {\n        const articleHeight = lastArticle.getBoundingClientRect().height;\n        window.scrollBy({\n            top: articleHeight * 2,\n            left: 0,\n            behavior: 'smooth',\n        });\n    } else {\n        console.error('Were sorry, but you have reached the end of search results.');\n    }\n}"],"names":["BASE_URL","API_KEY","PER_PAGE","fetchImages","query","currentPage","params","url","data","axios","error","renderImages","images","acc","item","searchForm","imagesBoxEl","loadMore","messageBox","pages","gallery","handleSubmit","handleLoadMore","event","form","response","showMessage","imagesMarkup","SimpleLightbox","handleScrollView","message","lastArticle","articleHeight"],"mappings":"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"}